{
  "constraints": {
    "licensing": [
      "Do not copy proprietary text; author original rationale."
    ],
    "privacy": [
      "Do not include secrets or personal data unless explicitly required."
    ],
    "safety": [
      "Do not overwrite existing DRR files.",
      "Use the next available numeric prefix based on existing files."
    ]
  },
  "conformance": {
    "checklist": [
      "inputs_validated",
      "outputs_listed",
      "u_work_emitted",
      "deterministic_naming",
      "inventory_updated"
    ]
  },
  "dependencies": {
    "skills": [],
    "tools": [
      "list_dir",
      "view_file",
      "write_to_file"
    ]
  },
  "eval": {
    "acceptance_criteria": [
      "Creates a DRR markdown file in design/decisions/ with a numeric prefix.",
      "The DRR includes Context, Decision, and Consequences sections.",
      "If telemetry/log-work is present, a U.Work record is attempted."
    ],
    "tests": [
      {
        "expected": {
          "drr_path": "design/decisions/<next_id>-adopt-skillspec-v0-1-0.md",
          "drr_path_pattern": "^design/decisions/\\\\d{3}-adopt-skillspec-v0-1-0\\\\.md$"
        },
        "input_fixture": {
          "context": "We need a structured, machine-validated format for defining skills.",
          "decision": "Adopt SkillSpec v0.1.0 for all skill definitions and validate in CI.",
          "title": "Adopt SkillSpec v0.1.0",
          "work_context": "Skills"
        },
        "name": "basic-drr",
        "notes": "Machine-checkable: match drr_path_pattern; <next_id> is the next sequential 3-digit prefix."
      },
      {
        "expected": {
          "drr_path": "design/decisions/<next_id>-separate-design-and-runtime-artifacts.md",
          "drr_path_pattern": "^design/decisions/\\\\d{3}-separate-design-and-runtime-artifacts\\\\.md$"
        },
        "input_fixture": {
          "context": "We need a clear separation between design-time docs and runtime outputs.",
          "decision": "Keep docs/specs under design/ and generated outputs under runtime/.",
          "title": "Separate design and runtime artifacts",
          "work_context": "Tooling"
        },
        "name": "basic-drr-2",
        "notes": "Machine-checkable: match drr_path_pattern; <next_id> is the next sequential 3-digit prefix."
      }
    ]
  },
  "failure_modes": [
    "Missing required inputs (title, context, decision).",
    "Failed to create or access design/decisions/.",
    "Failed to determine the next DRR id.",
    "Failed to write DRR file.",
    "Optional telemetry logging failed (telemetry/log-work unavailable or errored)."
  ],
  "id": "design/record-drr",
  "inputs": [
    {
      "description": "Short title of the decision.",
      "name": "title",
      "required": true,
      "type": "string"
    },
    {
      "description": "Problem context for the decision.",
      "name": "context",
      "required": true,
      "type": "string"
    },
    {
      "description": "Decision statement describing the solution.",
      "name": "decision",
      "required": true,
      "type": "string"
    },
    {
      "description": "Optional work context used when logging U.Work.",
      "name": "work_context",
      "required": false,
      "type": "string"
    }
  ],
  "intent": {
    "goal": "Create a DRR markdown file that captures context, decision, and consequences.",
    "non_goals": [
      "Does not make the decision; only records it.",
      "Does not modify or overwrite existing DRRs.",
      "Does not enforce decision content beyond the DRR structure."
    ]
  },
  "metadata": {
    "authors": [
      "FPF Foundry"
    ],
    "created": "2026-01-12",
    "tags": [
      "design"
    ],
    "updated": "2026-01-12"
  },
  "name": "Record DRR",
  "outputs": [
    {
      "description": "Path to the generated DRR markdown file in design/decisions/.",
      "name": "drr_path",
      "type": "string"
    }
  ],
  "procedure": [
    {
      "instruction": "Validate required inputs: title, context, decision.",
      "step_id": "step-validate-inputs"
    },
    {
      "instruction": "Resolve the design/decisions/ directory and create it if missing.",
      "step_id": "step-resolve-target"
    },
    {
      "instruction": "Determine the next numeric DRR id based on existing decisions files.",
      "step_id": "step-next-id"
    },
    {
      "instruction": "Format the filename as <NNN>-<kebab-title>.md.",
      "step_id": "step-format-filename"
    },
    {
      "instruction": "Construct the DRR content with Status, Context, Decision, and Consequences sections.",
      "step_id": "step-build-content"
    },
    {
      "instruction": "Write the DRR markdown file to design/decisions/.",
      "step_id": "step-write-file"
    },
    {
      "instruction": "If telemetry/log-work is available, log the DRR action with method design/record-drr (Pattern E.9).",
      "step_id": "step-log-work"
    }
  ],
  "schema_version": "0.1.0",
  "summary": "Records a formal Design-Rationale Record (DRR) for architectural decisions.",
  "version": "0.1.0"
}
